# Урок 49. Методологии разработки. Git flow. CI/CD. Docker

В этой лекции поговорим о том, как разработка происходит в реальности. Как разработчики взаимодействуют между собой,
какие еще роли бывают в команде и зачем они нужны. Как чаще всего используется git. И как при правильном подходе можно
автоматизировать все процессы деплоймента.

В достаточно крупных компаниях процессами автоматизации занимаются отдельные специалисты, называются DevOps (Development
and Operation) или даже DevSecOps (Development, Security and Operations). Но в небольших компаниях этим занимаются сами
разработчики, поэтому я считаю, что нам необходимо понимать как это устроено.

## Методологии разработки

Методология разработки ПО – это процесс описания того, как определенный продукт будет разрабатываться, то есть один из
способов организации коллективной разработки. Существует множество разных моделей такого процесса, каждая из которых
описывает свой подход и нельзя сказать, что среди них выделяется одна, которую нужно использовать в каждом проекте, всё
сугубо ситуативно.

По сути это правила и обязанности сотрудников при разработке программного обеспечения, и какие вообще нужны специалисты.

На самом деле их довольно много, я знаю как минимум 7, но в реальности в современном мире я сталкивался только с 3-я,
и то `scrum` очень сильно впереди по кол-ву команд которые его используют, давайте разбираться

Предлагаю рассмотреть подробнее.

### Waterfall

Вотерфол он же водопад.

Waterfall (каскадная, водопадная) – одна из самых старых методологий и подразумевает строгое последовательное выполнение
всех этапов, каждый из которых должен завершиться перед началом следующего. То есть переход на следующий этап означает
полное завершение работ на предыдущем. На картинке показано, что сначала мы анализируем задачу (документируем задания,
обговариваем сложности), потом происходит дизайн (на этом этапе формируется структура проекта), дальше кодинг и
тестирование. Возвраты на следующие этапы не предусмотрены. Использовать такую систему рекомендуется в небольших
проектах, где известны заранее требования и мала вероятность, что они будут меняться.

![](https://cdn.javarush.ru/images/article/c86b527c-ff58-4b9d-b625-00e2c6f1b1cd/512.webp)

Если мы предположим, что мы разрабатываем автомобиль, что бы сделать это по вотерфолу, то нужно дать чёткую задачу
команде проектирования, когда вся документальная работа будет закончена, нужно прейти к этапу дизайна и проработке
автомобиля, потом собрать прототип, после чего провести тестирование.

Преимущества:

- Полная и согласованная документация на каждом этапе;
- Простота использования;
- Стабильные требования.
- Бюджет и дедлайны заранее определены

Недостатки:

- Большое количество документации;
- Не очень гибкая система;
- Нет возможности вернуться на шаг назад.

### Kanban

Канбан – система, построенная на визуализации процесса выполнения задач команды. Основная идея в этой системе уменьшать
количество задач выполняющихся в данный момент (в колонке «in progress»). В Канбане на первом месте задачи. Хорош для
проектов которые в стадии поддержки где основной
функционал уже разработан и остались минимальные доработки и багофиксинг.

В канбане задачи сдаются индивидуально. Задача независимо от других задач проходит по всем этапам на доске и как только
она выполнена её можно показать заказчику.

Канбан доска состоит из колонок, каждая из которых это отдельный процесс разработки. На некоторые столбцы(например, in
progress) вводят ограничения по количеству тасок, которые там могут находиться. Это помогает легко и быстро находить
проблемные места в распределении задач. На картинке пример самой просто такой доски. Количество колонок и названия могут
меняться, назову самые распространенные:

![](https://cdn.javarush.ru/images/article/372fcb1e-ddbf-40dd-ad32-113572225d3e/512.webp)

На самом деле колонок может быть какое угодно кол-во и быть самыми разнообразными

Например:

- To do – список задач, которые надо сделать
- In progress – задачи над которыми ведется работа в данный момент
- Code review – задачи, которые сделаны и отправлены на ревью
- In testing – задачи, готовые к тестированию
- Done – сделанные задачи.

Преимущества:

- Простота использования.
- Наглядность.(помогает в нахождении узких мест, упрощает понимание)
- Высокая вовлеченность команды в сам процесс.
- Высокая гибкость в разработке.

Недостатки:

- Нестабильный список задач.
- Сложно применять на долгосрочных проектах.
- Отсутствие жестких дедлайнов.

В случае с разработкой автомобиля это бы означало, что мы имели бы кучу разбитых задач, например, спроектировать колесо,
продумать трансмиссию итд. И ответственные за это люди. В реальности встречал только на саппорт проектах. Это такие где
всё давно работает и необходимо только поддерживать или вносить небольшие правки. Но канбан доска очень и очень часто
используется как инструмент внутри процесса scrum, о нём и поговорим.

### Scrum

О нём сильно детальнее.

На самом деле Scrum это лишь подвид методологии которая называется Agile.

Суть Agile заключается в его дословном переводе: Agile - гибкий. Смысл заключается в том, что бы сконцентрироваться на
результате при этом имея возможность гибкого управления и правок в процессе разработки.

Как его вообще придумали? Вернёмся на сто лет назад и к примеру со сборкой автомобиля. Мы Генри Форд и хотим первыми
собрать массовый, серийный автомобиль. Допустим мы потратили 2 года и 2 миллиона долларов на проектную документацию,
потом 3 года и 4 миллиона на чертежи, потом 2 миллиона и 1 год на сборку
прототипа и собираемся перейти к тестированию. И на этапе тестирования в первый день мы выясняем, что в документации
были допущены ошибки при вычислениях, и наш автомобиль переворачивается на каждом повороте.

Вывод, мы потратили 6 лет и 8 миллионов на работу, которую надо начинать сначала, потому что документацию нужно начинать
сначала и мы понятия не имеем как изменения связанные с поворотами повлияет на остальную систему.

Такой подход никого не устраивал, и был придуман Agile, суть которого сводится к тому, что бы ввести временные циклы
разработки в конце которых всегда получается како-то результат. Например, мы вводим цикл в 3 месяца и каждые 3 месяца
смотрим на результаты, например, у нас уже есть мотор и мы хотим убедиться, что он сможет крутить колёса, и собираем
только мотор, колёса и все связующие их детали, если в конце такого цикла, всё хорошо, то идём дальше, если нет, ищем
ошибку, но мы потеряли всего 3 месяца, а не 6 лет. Если проблема обнаружилась на более поздних этапах, мы всегда можем
вернуться к результатам такого цикла и посмотреть лишь то, что было разработано на этом этапе.

Такие циклы разработки называются спринтами.

![](https://preview.redd.it/m3zuewzit0z81.png?width=960&crop=smart&auto=webp&s=acb2ac666c10ecebc786ef793d17462cb43cd895)

В итоге мы получаем более долгий процесс, потому что мы в любой момент можем изменить цели или детали текущей работы, но
при этом мы очень сильно уменьшаем бюджет, из-за сведения глобальных ошибок к нулю. Практика последних 100 лет показала,
что этот подход практически всегда выходит сильно дешевле если вы создаёте что угодно, сложнее гвоздя.

Из личной практики, клиент почти никогда не знает что он хочет, есть только примерное понимание того как всё должно быть
в конце.

Если в одно предложение, то суть сводится к фразе, начинали делать автомобиль, в процессе создали вертолёт, а сейчас
переделываем его в подводную лодку, но клиент счастлив и платит, потому что именно она ему оказалась и нужна.

![](https://codetiburon.com/app/uploads/2017/02/what-is-the-difference-between-agile-and-waterfall-model.png)

### Роли в скрам команде

В рамках скрама существует три основные роли:

- Product Owner (PO) - Заказчик, чаще всего это специально назначенный менеджер который занимается постановкой задач и
  собиранием требований от так называемых stakeholders, в случае больших компаний почти никогда не бывает одного
  выгодоприобретателя, и важно, что бы задачи ставил только один человек.
- Developer team member - Это вы. И не только вы, это любые люди которые участвуют в процессе разработки, тестировщики,
  дизайнеры, бизнес аналитики итд. Их роль работать работу.
- Scrum master - Это еще один менеджер. Его задача это защита команды и отслеживания соблюдения скрам процессов, о них
  дальше. Зачем защищать команду? Потому что ПО всегда заинтересован в том, что бы команда выдавала максимальный
  результат, несмотря ни на что. В такой ситуации, если бы не было скрам мастера, то ПО был бы только рад дать задач
  столько, что бы они занимали 24/7, одна из основных задач SM, следить что бы так не было.

### Процессы и термины

Что нужно сделать, что бы организовать такой процесс. В первую очередь необходимо определить удобный для вас размер
спринта, считается что он должен быть от 1 до 4 недель. Я в реальности за исключением одного проекта работал с двух
недельными спринтами, в том исключении было 3 недели. Это размер определяют все вместе (Dev Team + PO + SM)

![](https://www.codeguru.com/wp-content/uploads/2021/07/Scrum-framework.png)

Следующий этап это заполнение беклога продукта.

Беклог это место, где будут лежать ваши задачи, чаще всего это разные специализированные сервисы, очень часто это Jira
или Azure Devops, но на самом деле их существует очень, и очень много.

Беклог продукта заполняет продукт овнер, чем детальнее описана задача тем проще потом её выполнять, поэтому следить за
детализацией беклога, это задача скрам мастера и бизнес аналитиков если они есть. Бизнес аналитик это чаще всего
переводчик с языка заказчика на технический и наоборот, очень полезные ребята.

В идеальном мире, в беклоге продукта должно быть задач не меньше чем на 2 спринта.

После чего начинается процесс планирования спринта, обычно этим занимается дев команда, как именно это происходит,
обсудим
дальше, пока общая идея.

Результатом планирования является беклог спринта, то есть по сути список выбранных задач на следующий цикл разработки.

Когда беклог спринта готов, начинается процесс разработки.

Важным элементом разработки является ежедневный митинг всей командой. Такой митинг может называться по разному: daily,
scrum, stand up итд. могут быть сочетания этих слов

Зачем он нужен?

На таком митинге каждый участник команды отвечает на 3 самых главных вопроса:

- Что сделал?
- Что собираешься делать?
- Нет ли блокирующих обстоятельств?

Зачем на них отвечать надеюсь пояснять не надо.

В конце спринта результатом чаще всего является деплой результата, иногда просто демонстрация результатов продукт
овнеру. Такой митинг называется review.

После ревью обязательно проходит ретроспектива. Это еще один митинг который нужен для улучшения скрам процессов.

![](https://i.ytimg.com/vi/RD60Js82D7Q/maxresdefault.jpg)

Что это такое? Это митинг на котором необходимо нарисовать на доске три колонки:

- Плюсы спринта
- Минусы спринта
- Действия

Первые два заполняются участниками команды. Каждый озвучивает плюсы и минусы которые он увидел.

Если за плюсы обычно просто хвалят, то минусы нужно разбирать.

Например, плюс, что тестировщики очень хорошо сработали, и вовремя нашил критичный баг.

А минус, что у проекта нет документации, допустим, с логинами и паролями от серверов, а они нужны.

На каждый минус прописывается действие, в моём примере это будет, создать файл с паролями.

Дальше каждый участник команды имеет какое-то количество голосов, там где я работал, это чаще всего было 2. Которые ты
отдаёшь за те действия которые для тебя наиболее критичны, несколько самых проголосованных берутся в работу и
назначаются ответственные. Следующая ретро начинается с обсуждения прошлых задач и результатов.

Если скрам построен нормально, то на первых спринтах экшенов очень много, но чем дальше заходит процесс, тем их меньше,
и тем больше заполняются плюсы и уходят минусы.

Необходимо для того, что бы помочь самой команде в её процессах.

Итого обязательные митинги:

- Пленинг
- Дейли
- Ревью
- Ретроспектива

После этого начинаем с начала с пленинга спринта. И так до пенсии.

![](https://habrastorage.org/r/w1560/getpro/habr/post_images/81c/22f/a3b/81c22fa3b8cc923b6bf5181cdc5ea2b3.jpg)

Мем исключительно шутки ради, на самом деле хорошая методология :)

### Процесс пленинга, стори поинты, велосити и диаграммы сгорания

Процесс планирования спринта не так прост как кажется. Какая возникает проблема? Как понять какое кол-во и каких задач
команда вообще может сделать?

Что бы определить это вводится специальное понятие, story points. Стори поинты это условная сложность задачи, которая не
зависит ни от ваших навыков, ни от размера команды. Что бы понять суть нужно задать себе вопрос, что проще почистить,
банан, папайю или мандарин ? Скорее всего вне зависимости от своих навыков и размера команды вы сможете сказать, что
проще, а что сложнее.

Как эта сложность определяется? Обычно при помощи скрам покера.

#### Скрам покер

Если процесс проходит оффлайн то каждому участнику команды выдают карточки с цифрами и символами:

```python
[1, 2, 3, 5, 8, 13, 20, 40, 100, 'Чашка кофе', 'Бесконечность']
```

![](https://training.qatestlab.com/wp-content/uploads/2018/07/HEAD_Planning_Poker-1.jpg)

Могут быть варианты, но суть всегда одна.

Берём задачу из беклога, обсуждаем, и после обсуждения все одновременно переворачивают карту, которую считают
правильной.

Если ты не понимаешь сути задачи, например задача по дизайну, а ты бекэнд разработчик, или наоборот, то выбрасываешь
карту с кофе, как символ, что ты не участвуешь в обсуждении этой задачи.

И бесконечность или символ `?` в случае если ты считаешь, что эту задачу вообще не возможно сделать или нам не хватает
деталей для её оценки.

Если нет сильно большого разброса, то значение выбирается большинством, например 1 человек кинул 2, 3 человека 3 и еще
один 5, то просто возьмут 3

А если кто-то кидает сильно меньше или сильно больше начинается обсуждение и переголосование, возможно этот кто-то знает
простой способ решения или наоборот видит какой-то подводный камень.

Каждой задаче проставляется сложность. Обычно сложность выше чем 20, и даже 13 считается слишком высокой, а значит
задачу нужно разбить на более мелкие, которые будут оценены не выше чем в 8. Хотя бывают и исключения.

#### Пленинг и велосити

Когда идёт первый спринт, никто ни вы, ни ПО, ни СМ не знают сколько задач вы можете выполнить, поэтому берётся то
кол-во задач, которые вы считаете, что вы можете сделать.

![](https://memepedia.ru/wp-content/uploads/2022/05/mne-pohuj-ja-tak-chuvstvuju-tinkov.jpg)

Сумма всех стори поинтов которые вы набрали в спринт называется velocity. И по результатам первого спринта становится
понятно, вы взяли много, мало, или как раз, что и можно обсудить на ретроспективе.

Первые несколько спринтов цифра может очень сильно меняться от спринта к спринту, но через 3-4 спринта становится
понятно какая велосити у вашей команды.

И основываясь на этой цифре ПО и СМ могут понимать какое реальное кол-во работы за какое время сможет сделать именно эта
команда.

В идеальном мире ваша велосити должна расти, но это очень индивидуально.

#### Диаграммы сгорания

Важным элементом является диаграмма сгорания задач в спринте.

Задачи в скраме так же попадают на доску задач где у статусов может быть разный вес.

Например:

- Нужно сделать - 0 баллов
- В процессе - 1 балл
- На тестировании - 2 балла
- На проверке у ПО - 3 балла
- Готово - 4 балла

И благодаря этим цифрам можно построить график того как именно меняется процесс выполнения спринта в реальном времени.

Выглядит примерно так:

![](https://upload.wikimedia.org/wikipedia/commons/0/05/SampleBurndownChart.png)

Естественно чем вы ближе к идеальной прямой тем лучше. И такая диаграмма может помочь менеджерам следить за процессом
выполнения, а вам понять есть ли у вас проблемы.

Доступ к такой диаграмме должен быть у всех участников команды.

Такая же диаграмма может быть построена для всего проекта, но на практике почти никогда не делается, потому что никто не
знает, сколько раз изменятся\добавятся требования.

### Недостатки скрама

- Сложно оценить трудозатраты и стоимость, требуемые на разработку
- Сложно определить самые узкие места до начала разработки.
- Необходимость вовлечения каждого в разработку других членов команды.

Финал проекта может быть очень сильно сдвинут от планов заказчика, по всем уже озвученным причинам

На начале проекта очень много случайных факторов. Неправильная оценка сил, не налаженные процессы, нет чёткого понимания
как решать блокеры.

Скрам подразумевает, что практически каждый может заменить другого в команде, на практике это всегда не так, даже в
рамках разработки, джун почти никогда не заменит синьора, что уже говорить о том, что бы дев выполнял задачи за
дизайнера. Так что сложно равномерно распределить задачи пока процесс не "встанет на рельсы"

